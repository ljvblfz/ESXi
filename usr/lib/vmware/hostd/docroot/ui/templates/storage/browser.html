<div ng-controller="StorageDatastoreBrowserController">
   <div
      ng-if="showActionBar"
      vui-action-bar="actionBarOptions"
      style="position: absolute; top: 37px; left: 5px;"></div>

   <div
      style="position: absolute; right: 12px; top: 38px; line-height: 18px;"
      ng-if="uploadInProgress">
      {{'storage.datastore.browser.dialog.upload.inProgress' |
         translate:uploadData}}
      <div style="margin-left: 5px; float: right;"
         vui-progress-bar="uploadProgress"></div>
   </div>

   <div
      ng-file-select
      id="datastore-upload-field"
      style="display: none;"
      ng-model="files"></div>

   <div class="datastore-browser"
      ng-style="showActionBar ? {'top': '62px'} : {'top': '30px'}" style="background: white">
      <div ng-show="!loadingDatastores" id="datastore-selector" class="datastore-selector"
         style="overflow: hidden; position: relative;">
         <div style="width: 100%;">
            <ul>
               <li ng-repeat="datastore in datastores"
                  ng-click="selectDatastore(datastore)"
                  ng-class="{'selected': datastore.selected}">
                  <em ng-class="datastore.icon"></em>{{datastore.name}}</li>
            </ul>
         </div>

         <div id="datastore-browser-datastore-resize-handle" class="ui-resizable-handle ui-resizable-e"
            style="position: absolute; text-align: right; bottom: 0px; top: auto; right: 2px; width: 1.3rem; height: 19px;">
            <img src="images/horizontalResize.png" alt="{{'root.resize' | translate}}"/>
         </div>
      </div>

      <div id="datastore-browser-folder-{{$index}}"
            ng-repeat="folder in directoryStack track by $index"
            class="datastore-folder"
            style="overflow: hidden; position: relative;">
         <div style="width: 100%;">
            <ul>
               <li ng-repeat="file in folder.file"
                     ng-click="selectFile(file)"
                     ng-right-click="showContextMenu('storage.datastore.browser.file', [file], $event)"
                     ng-class="{
                        'selected': file.selected,
                        'enabled': file.enabled,
                        'disabled': !file.enabled
                     }">
                  <em class="esx-icon-datastore-{{file.type}}"></em>{{file.path}}</li>
            </ul>
         </div>

         <div id="datastore-browser-resize-handle-folder-{{$index}}"
               style="position: absolute; text-align: right; bottom: 0px; top: auto; right: 2px; width: 1.3rem; height: 19px;"
               class="ui-resizable-e">
            <img src="images/horizontalResize.png" alt="{{'root.resize' | translate}}"/>
         </div>
      </div>

      <div ng-show="loadingFolder"
            class="datastore-folder"
            style="overflow: hidden; position: relative;">
         <div class="loading"></div>
      </div>

      <div ng-show="errorFolder"
            class="datastore-folder"
            style="overflow: hidden; position: relative;">
         <div class="error" style="
               padding: 110% 30px 0 30px;
               white-space: normal;
               text-align: center;">
            {{'general.loading.error' | translate}}</div>
      </div>

      <div ng-show="currentFile !== null"
            id="datastore-browser-file"
            class="datastore-file"
            style="overflow: hidden; position: relative;">
         <div class="datastore-file" style="width: 100%;"
               ng-right-click="showContextMenu('storage.datastore.browser.file', [currentFile], $event)">
            <div style="padding: 10px; text-overflow: ellipsis; overflow: hidden;">
               <img src="images/datastore/file-{{currentFile.type}}.png"
                     style="margin-bottom: 5px; width: 32px;"/><br />
               {{currentFile.path}}<br />
               {{currentFile.fileSize|formatMemory}}<br />
               {{currentFile.modificationFormatted}}<br />
            </div>
         </div>

         <div id="datastore-browser-resize-handle-file"
            style="position: relative; text-align: right; bottom: 17px; left: 0px; top: auto; padding-right: 3px; width: auto; height: 17px;"
            class="ui-resizable-e">
            <img src="images/horizontalResize.png" alt="{{'root.resize' | translate}}"/>
         </div>
      </div>
   </div>
   <div class="datastore-path">
      <em ng-if="!fileNameField" class="esx-icon-datastore"></em>
      <span ng-if="!fileNameField">[{{currentDatastore.name}}]</span>
      <span ng-if="currentDirectory !== null && !fileNameField">{{currentDirectory.fullPath}}/</span><span ng-if="currentFile !== null && !fileNameField">{{currentFile.path}}</span>
      <input ng-if="fileNameField" type="text" ng-model="$parent.providedFileName"/>
   </div>
</div>
